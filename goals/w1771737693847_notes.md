# n8n Integration with OpenClaw/Juno - Implementation Notes

**Date:** 2026-02-24  
**Action Item Completed:** ai-1771737727130  
**Research by:** AI Agent

---

## 1. What is n8n and How It Works

### Overview
**n8n** is a workflow automation platform that uniquely combines AI capabilities with business process automation. It offers technical teams the flexibility of code with the speed of no-code.

### Core Concepts
- **Nodes**: Each node represents a specific action (send email, update spreadsheet, fetch API data)
- **Workflows**: A collection of nodes connected together to automate a process
- **Triggers**: Events that start a workflow (webhooks, schedules, external events)
- **400+ Integrations**: Pre-built connectors for popular services (Slack, Gmail, GitHub, etc.)

### Key Features
| Feature | Description |
|---------|-------------|
| Visual Builder | Drag-and-drop interface for creating workflows |
| Self-Hosted | Can run on your own infrastructure (Docker, npm) |
| HTTP Requests | Generic API integration via HTTP Request node |
| Webhook Support | Expose HTTP endpoints to trigger workflows |
| Code Support | Execute custom JavaScript/Python in workflows |
| AI Integration | Native AI nodes for GPT, Claude, etc. |

### Deployment Options
1. **n8n Cloud**: Managed service (paid tiers)
2. **Self-Hosted (Docker)**: Recommended for privacy/control
3. **Self-Hosted (npm)**: Direct Node.js installation

---

## 2. How to Integrate n8n with OpenClaw/Juno

### Architecture Overview
```
┌─────────────────┐     Webhook      ┌─────────────────┐
│   OpenClaw      │ ◄──────────────► │      n8n        │
│   (AI Agent)    │                  │  (Workflows)    │
│   Port 3456     │                  │  Port 5678      │
└────────┬────────┘                  └────────┬────────┘
         │                                    │
         ▼                                    ▼
┌─────────────────┐                  ┌─────────────────┐
│  Claude/GPT     │                  │  400+ External  │
│  API            │                  │  Services       │
└─────────────────┘                  └─────────────────┘
```

### Integration Methods

#### Method A: OpenClaw → n8n (Trigger Workflows)
OpenClaw can call n8n webhooks directly to trigger workflows:

```bash
# From OpenClaw, call a n8n workflow
curl -X POST "http://n8n:5678/webhook/my-workflow" \
  -H "Content-Type: application/json" \
  -d '{"data": "from openclaw"}'
```

**Configuration in n8n:**
1. Add a **Webhook node** as the trigger
2. Set method to POST
3. Configure authentication (optional but recommended)
4. Use the webhook URL in OpenClaw calls

#### Method B: n8n → OpenClaw (Trigger Agent)
n8n can call OpenClaw's webhook endpoints to invoke the AI agent:

```bash
# n8n HTTP Request node configuration
POST http://openclaw:18789/hooks/agent
Headers:
  Authorization: Bearer YOUR_HOOK_TOKEN
  Content-Type: application/json
Body:
  {
    "message": "Summarize this data and send to Slack",
    "name": "Data Processor",
    "agentId": "main",
    "wakeMode": "now",
    "deliver": true,
    "channel": "slack"
  }
```

**OpenClaw Webhook Configuration** (`config/openclaw.json`):
```json
{
  "hooks": {
    "enabled": true,
    "token": "${OPENCLAW_HOOKS_TOKEN}",
    "path": "/hooks",
    "allowedAgentIds": ["main", "hooks"]
  }
}
```

### Webhook Endpoints in OpenClaw

| Endpoint | Purpose | Payload |
|----------|---------|---------|
| `POST /hooks/wake` | Trigger heartbeat check | `{"text": "New email", "mode": "now"}` |
| `POST /hooks/agent` | Run agent with message | `{"message": "...", "agentId": "..."}` |

---

## 3. Use Cases for n8n + OpenClaw Combination

### Use Case 1: AI-Powered Email Triage
**Flow:**
1. n8n polls Gmail for new emails
2. n8n sends email content to OpenClaw via `/hooks/agent`
3. OpenClaw (AI) classifies and summarizes the email
4. OpenClaw sends summary back via n8n to Slack

**Value:** Automated inbox management with AI understanding

### Use Case 2: Multi-Model Content Validation
**Flow:**
1. OpenClaw drafts content
2. OpenClaw triggers n8n webhook to validate
3. n8n calls ChatGPT, Gemini, and Claude APIs
4. n8n aggregates responses and sends back to OpenClaw
5. OpenClaw reviews discrepancies and finalizes

**Value:** Fact-checking with multiple AI models

### Use Case 3: Social Media Monitoring with AI Responses
**Flow:**
1. n8n monitors Twitter/LinkedIn for mentions
2. New mention triggers webhook to OpenClaw
3. OpenClaw analyzes sentiment and drafts response
4. OpenClaw sends response back to n8n
5. n8n posts reply (with human approval option)

**Value:** AI-powered social media management

### Use Case 4: Automated Reporting
**Flow:**
1. n8n collects data from multiple sources (analytics, sales, etc.)
2. n8n sends aggregated data to OpenClaw
3. OpenClaw generates natural language report
4. OpenClaw sends formatted report back to n8n
5. n8n emails report to stakeholders

**Value:** Natural language reporting from structured data

### Use Case 5: GitHub PR Review Automation
**Flow:**
1. GitHub webhook → n8n (PR opened event)
2. n8n filters and forwards to OpenClaw `/hooks/agent`
3. OpenClaw reviews code changes
4. OpenClaw posts review comments via n8n → GitHub API

**Value:** AI-assisted code review

---

## 4. Setup/Installation Steps

### Prerequisites
- Docker and Docker Compose installed
- Anthropic API key (for Claude)
- Optional: OpenAI/Google AI keys for multi-model workflows

### Option 1: Pre-Configured Stack (Recommended)
The easiest way is using the community stack:

```bash
# Clone the pre-configured stack
git clone https://github.com/caprihan/openclaw-n8n-stack.git
cd openclaw-n8n-stack

# Copy and edit environment
cp .env.template .env
nano .env

# Start services
docker-compose up -d
```

**Services available:**
- n8n: http://localhost:5678
- OpenClaw: http://localhost:3456

### Option 2: Manual Setup

#### Step 1: Install n8n via Docker

```yaml
# docker-compose.yml
version: '3.8'
services:
  n8n:
    image: n8nio/n8n:latest
    ports:
      - "5678:5678"
    environment:
      - N8N_BASIC_AUTH_ACTIVE=true
      - N8N_BASIC_AUTH_USER=admin
      - N8N_BASIC_AUTH_PASSWORD=your-password
      - N8N_WEBHOOK_URL=http://localhost:5678/
    volumes:
      - ~/.n8n:/home/node/.n8n
```

```bash
docker-compose up -d
```

#### Step 2: Configure OpenClaw Hooks

Edit `~/.openclaw/config/openclaw.json`:

```json
{
  "hooks": {
    "enabled": true,
    "token": "your-secure-random-token",
    "path": "/hooks",
    "defaultSessionKey": "hook:ingress",
    "allowRequestSessionKey": false,
    "allowedSessionKeyPrefixes": ["hook:"],
    "allowedAgentIds": ["*"]
  }
}
```

#### Step 3: Verify Connectivity

From OpenClaw, test n8n connectivity:
```bash
curl http://n8n:5678/healthz
```

From n8n, test OpenClaw (using HTTP Request node):
```
GET http://openclaw:18789/healthz
```

### Security Best Practices

1. **Use strong tokens** - Never use default passwords
2. **HTTPS in production** - Put behind reverse proxy (nginx/traefik)
3. **Network isolation** - Keep services on internal Docker network
4. **Credential management** - Use n8n's encrypted credential store
5. **Rate limiting** - Configure rate limits on webhook endpoints
6. **Token separation** - Don't reuse gateway tokens for hooks

---

## 5. Example Workflows

### Example 1: OpenClaw → n8n → Slack Notification

**n8n Workflow Setup:**
1. **Trigger**: Webhook node
   - Method: POST
   - Path: `slack-notify`
   - Response Mode: Response

2. **Transform**: Set node
   - Map incoming data to Slack format

3. **Action**: Slack node
   - Operation: Post Message
   - Channel: #notifications
   - Text: `{{ $json.message }}`

**OpenClaw Call:**
```bash
curl -X POST "http://n8n:5678/webhook/slack-notify" \
  -H "Content-Type: application/json" \
  -d '{"message": "Task completed successfully!"}'
```

### Example 2: GitHub → n8n → OpenClaw → GitHub

**n8n Workflow:**
1. **Trigger**: GitHub Trigger node
   - Event: Pull Request opened
   - Repository: your-org/your-repo

2. **Filter**: IF node
   - Check if PR is not draft

3. **Action**: HTTP Request node → OpenClaw
   ```
   POST http://openclaw:18789/hooks/agent
   Headers:
     Authorization: Bearer YOUR_TOKEN
   Body:
     {
       "message": "Review this PR: {{ $json.pull_request.html_url }}",
       "name": "CodeReview",
       "wakeMode": "now"
     }
   ```

### Example 3: Scheduled Report with AI Analysis

**n8n Workflow:**
1. **Trigger**: Schedule Trigger (daily at 9 AM)

2. **Data Collection**: HTTP Request nodes
   - Fetch analytics from multiple APIs

3. **Aggregate**: Code node (JavaScript)
   - Combine data into structured format

4. **AI Analysis**: HTTP Request → OpenClaw
   ```
   POST /hooks/agent
   Body:
     {
       "message": "Analyze this data and write a summary: {{ $json }}",
       "name": "DailyReport",
       "deliver": false
     }
   ```

5. **Wait**: Wait for webhook response (optional)

6. **Distribute**: Email node
   - Send AI-generated report to team

### Example 4: Email Triage (Complete)

**n8n Workflow:**
1. **Trigger**: Gmail Trigger node
   - Watch for new emails with label:inbox

2. **Extract**: Gmail node
   - Get full email content

3. **AI Process**: HTTP Request → OpenClaw
   ```json
   {
     "message": "Categorize and summarize: Subject: {{ $json.subject }}, Body: {{ $json.body }}",
     "name": "EmailTriage",
     "deliver": false
   }
   ```

4. **Route**: Switch node
   - Based on AI category (urgent/important/low)

5. **Action**: Slack/Email nodes
   - Notify appropriate channels

### Example 5: Two-Way Integration Pattern

**Pattern:** OpenClaw initiates → n8n processes → OpenClaw finalizes

```
OpenClaw: "Check 5 news sources and summarize"
    ↓
n8n: HTTP Request nodes fetch articles
    ↓
n8n: Aggregate to single payload
    ↓
n8n: POST to OpenClaw /hooks/agent with articles
    ↓
OpenClaw: Summarize and send back to user
```

---

## Quick Reference: Common n8n Nodes for OpenClaw Integration

| Node | Use Case |
|------|----------|
| Webhook | Trigger workflows from OpenClaw |
| HTTP Request | Call OpenClaw hooks or any API |
| Code | Transform data between formats |
| Set | Define variables and mappings |
| Wait | Pause for webhook response |
| Slack/Email/Telegram | Send notifications |

## Quick Reference: OpenClaw Hook Payloads

**Wake Hook:**
```json
{
  "text": "Description of event",
  "mode": "now"
}
```

**Agent Hook:**
```json
{
  "message": "Task for AI to perform",
  "name": "Hook identifier",
  "agentId": "main",
  "sessionKey": "hook:custom",
  "wakeMode": "now",
  "deliver": true,
  "channel": "telegram",
  "model": "anthropic/claude-sonnet-4-20250514",
  "thinking": "medium"
}
```

---

## Resources

- **n8n Docs**: https://docs.n8n.io/
- **n8n Community**: https://community.n8n.io/
- **OpenClaw Docs**: https://docs.openclaw.ai/
- **OpenClaw + n8n Stack**: https://github.com/caprihan/openclaw-n8n-stack
- **n8n Workflow Templates**: https://n8n.io/workflows

---

## Action Items Completed

- [x] **ai-1771737727130**: Add notes on how to implement n8n with Juno (OpenClaw) - Completed 2026-02-24

---

*Document posted to goal notes for goal w1771737693847*
